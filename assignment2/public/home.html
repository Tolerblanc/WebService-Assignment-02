<!doctype html>
<html>
    <head>
        <title>WebService Assignment 02</title>
        <script
            src="https://cdn.socket.io/4.7.2/socket.io.min.js"
            integrity="sha384-mZLF4UVrpi/QTWPA7BjNPEnkIfRFn4ZEO3Qt/HFklTJBj/gBOV8G3HcKn4NfQblz"
            crossorigin="anonymous"
        ></script>
        <script>
            const socket = io('http://localhost:3000');

            // 서버로부터 방 목록 업데이트 이벤트를 받음
            socket.on('updateRoomList', function (rooms) {
                const roomList = document.getElementById('roomList');
                roomList.innerHTML = ''; // 기존 목록을 초기화

                rooms.forEach((room) => {
                    // 각 방에 대한 정보를 목록에 추가
                    const roomElement = document.createElement('li');
                    roomElement.textContent = `${room.roomName} (현재 인원: ${room.capacity}/4)`;

                    // 방 클릭 이벤트 추가 (예: 방 입장)
                    roomElement.addEventListener('click', function () {
                        enterRoom(room.roomName);
                    });

                    roomList.appendChild(roomElement);
                });
            });

            function enterRoom(roomName) {
                // 방 입장 로직
                // 예: socket.emit('joinRoom', { roomName: roomName });
                // 이후 페이지 이동 또는 UI 업데이트
            }

            function createRoom() {
                // 방 생성 로직
                // 예: socket.emit('createRoom', { roomName: roomName });
                // 이후 페이지 이동 또는 UI 업데이트
            }
            function openModal() {
                document.getElementById('createRoomModal').style.display = 'block';
            }

            function closeModal() {
                document.getElementById('createRoomModal').style.display = 'none';
            }
        </script>
    </head>
    <body>
        <header>
            <button id="createRoomButton" onclick="openModal()">방 생성</button>
            <button id="viewRecordButton" onclick="window.location.href='/user/record'">전적 보기</button>
        </header>

        <section id="roomListSection">
            <h2>활성 게임 방</h2>
            <ul id="roomList">
                <!-- 여기에 방 목록이 동적으로 삽입됨 -->
            </ul>
        </section>

        <div id="createRoomModal" style="display: none">
            <label for="roomName">방 제목:</label>
            <input type="text" id="roomName" />
            <button onclick="createRoom()">확인</button>
            <button onclick="closeModal()">취소</button>
        </div>
    </body>
</html>
